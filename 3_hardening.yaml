---

  - name: Server Hardening
    hosts: all
    gather_facts: false

    become: true
    become_user: root



    tasks:

      - name: Gather information
        setup:
        register: info


      - name: RedHat 7/8
        vars:
        include_role:
          name: redhat-8
        when: info.ansible_facts.ansible_distribution_file_variety == "RedHat" and (info.ansible_facts.ansible_distribution_major_version == "7" or info.ansible_facts.ansible_distribution_major_version == "8")  


      - name: SUSE
        vars:
        include_role:
          name: suse-11
        when: info.ansible_facts.ansible_distribution_file_variety == "SUSE"


      - name: Ubuntu/Debian
        vars:
        include_role:
          name: debian
        when: info.ansible_facts.ansible_distribution_file_variety == "Debian"


      - name: RedHat 6
        vars:
        include_role:
          name: redhat-6
        when: info.ansible_facts.ansible_distribution_file_variety == "RedHat" and info.ansible_facts.ansible_distribution_major_version == "6"
